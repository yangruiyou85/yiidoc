Изменение разметки страницы
===========================

Такие особенности как "новые комментарии", "облако тэгов" лучше реализовывать
как [портлеты](http://ru.wikipedia.org/wiki/Портлет). Портлет — подключаемый
компонент пользовательского интерфейса, который рендерит фрагмент HTML-кода.
В этом разделе мы описываем, как установить архитектуру портлета для нашего блога.

Перед тем, как мы детально опишем создание портлетов, изменим расположение элементов
страницы так, что портлеты будут распологаться в боковой колонке.

Разметка страницы определяет, как использовать общие болки, такие как шапка или
подвал, на различных страницах, а также, как показывать элементы, специфичные
для конкретных страниц. В Yii разметка страницы определяется в отображении в
директории `protected/views/layouts`. Когда мы вызываем метод `render()` контроллера,
отображение автоматически встраивается в общую разметку. По умолчанию для
главной разметки используется отображение `main`, то есть файл
`/wwwroot/blog/protected/views/layouts/main.php`.

Для того, чтобы добавить боковую колонку мы можем добавить код прямо
в отображение `main`, однако боковая колонка появится также и на страницах
«О проекте» и «Контакты», что не всегда хорошо. Именно поэтому для разных страниц
нам понадобятся разные разметки.

Создадим две разметки: `column1` и `column2`. Первая будет содержать одну колонку,
вторая — две. Разметку `column2` будем использовать для страниц записей и
комментариев, а `column1` — для всех остальных страниц. Так как и `column1`
и `column2` имеют одинаковые блоки шапки и подвала, используем для них общую
разметке `main`.

Создадим разметку `column1` как описано выше:

~~~
[php]
<?php $this->beginContent('/layouts/main'); ?>
<div class="container">
	<div id="content">
		<?php echo $content; ?>
	</div><!-- content -->
</div>
<?php $this->endContent(); ?>
~~~

И разметку `column2`:

~~~
[php]
<?php $this->beginContent('/layouts/main'); ?>
<div class="container">
	<div class="span-18">
		<div id="content">
			<?php echo $content; ?>
		</div><!-- content -->
	</div>
	<div class="span-6 last">
		<div id="sidebar">
			здесь будут распологаться портлеты
		</div><!-- sidebar -->
	</div>
</div>
<?php $this->endContent(); ?>
~~~

В коде выше и `column1` и `column2` заключены между вызовами `beginContent`
и `endContent`, которые используют отображение `/layouts/main` в качестве
декоратора. Во всех главных разметках переменная `$content` содержит
результат работы приложения, который будет в них встроен.

Кроме изменения разметки, необходимо изменить CSS `/wwwroot/blog/css/main.css`
для того, чтобы добиться внешнего вида, который можно наблюдать
[в готовой демонстрации блога](http://www.yiiframework.com/demos/blog/).
Мы не будем детально останавливаться на этом моменте.

> Info|Информация: Каркас приложения, сгенерированный при помощи `yiic`
> использует CSS фреймворк [BluePrint](http://www.blueprintcss.org/),
> который сбрасывает шрифты и предоставляет стили для построения модульной сетки.
> Подробнее об использовании этого фреймворка можно прочитать в его документации.

После создания новых разметок, для их использования нам необходимо установить
свойство `layout` контроллеров. Пока у нас имеется три контроллера:
`SiteController`, `PostController` и `CommentController`. Контроллер
`SiteController` будет использовать в качестве разметки по умолчанию `column1`.
Два оставшихся контроллера будут использовать `column2`:

~~~
[php]
class PostController extends Controller
{
	public $layout='column2';
	…
}
~~~

> Tip|Подсказка: Если необходимо использовать главную разметку, отличную от той,
> что указана в свойстве `layout` контроллера, можно изменить её непосредственно
> в отображении простым присваиванием `$this->layout='newlayout';`.

<div class="revision">$Id: portlet.base.txt 1688 2010-01-08 14:28:20Z qiang.xue $</div>